These codes are modifed from: (MIT License)
https://github.com/kfirprods/NonInvasiveKeyboardHook